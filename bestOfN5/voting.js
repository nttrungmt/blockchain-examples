web3.personal.unlockAccount(eth.coinbase, "test");
nEther=web3.fromWei(eth.getBalance(eth.coinbase),"ether");
web3.miner.start(1);
while(nEther <= 10) {
  admin.sleep(1);
  nEther=web3.fromWei(eth.getBalance(eth.coinbase),"ether");
  //console.log("Current ether=" + nEther);
}
var candidateNames = [1,2];
var VotingContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"candidate","type":"uint256"}],"name":"validCandidate","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"numVoters","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"uid","type":"uint256"},{"name":"candidate","type":"uint256"}],"name":"voteForCandidate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getNumOfVoters","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"consensus","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"candidate","type":"uint256"}],"name":"totalVotesFor","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"candidateList","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"uid","type":"uint256"}],"name":"getVotesFor","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"maxVoters","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getNumOfCandidates","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"votesReceived","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"candidateNames","type":"uint256[]"},{"name":"maxNumVoters","type":"uint256"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"}]);
var deployedContract = VotingContract.new(candidateNames, 6,
  { from: web3.eth.accounts[0],
    data: '0x608060405234801561001057600080fd5b5060405161067c38038061067c833981018060405281019080805182019291906020018051906020019092919050505081600090805190602001906100569291906100ad565b508060028190555060025460405190808252806020026020018201604052801561008f5781602001602082028038833980820191505090505b50600490805190602001906100a59291906100ad565b50505061011f565b8280548282559060005260206000209081019282156100e9579160200282015b828111156100e85782518255916020019190600101906100cd565b5b5090506100f691906100fa565b5090565b61011c91905b80821115610118576000816000905550600101610100565b5090565b90565b61054e8061012e6000396000f3006080604052600436106100af576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806321b4bdde146100b45780634cbe32b8146100f9578063626b2c981461012457806365fc783c1461015b5780638ef3f76114610186578063a805f1ca146101b5578063b13c744b146101f6578063d40b65eb14610237578063d5e50a6314610278578063e8685ba1146102a3578063f3084a63146102ce575b600080fd5b3480156100c057600080fd5b506100df6004803603810190808035906020019092919050505061030f565b604051808215151515815260200191505060405180910390f35b34801561010557600080fd5b5061010e610366565b6040518082815260200191505060405180910390f35b34801561013057600080fd5b50610159600480360381019080803590602001909291908035906020019092919050505061036c565b005b34801561016757600080fd5b506101706103d6565b6040518082815260200191505060405180910390f35b34801561019257600080fd5b5061019b6103e0565b604051808215151515815260200191505060405180910390f35b3480156101c157600080fd5b506101e060048036038101908080359060200190929190505050610445565b6040518082815260200191505060405180910390f35b34801561020257600080fd5b50610221600480360381019080803590602001909291905050506104b2565b6040518082815260200191505060405180910390f35b34801561024357600080fd5b50610262600480360381019080803590602001909291905050506104d5565b6040518082815260200191505060405180910390f35b34801561028457600080fd5b5061028d6104f8565b6040518082815260200191505060405180910390f35b3480156102af57600080fd5b506102b86104fe565b6040518082815260200191505060405180910390f35b3480156102da57600080fd5b506102f96004803603810190808035906020019092919050505061050a565b6040518082815260200191505060405180910390f35b600080600090505b60008054905081101561035b578260008281548110151561033457fe5b9060005260206000200154141561034e5760019150610360565b8080600101915050610317565b600091505b50919050565b60015481565b6103758161030f565b151561038057600080fd5b60016003600083815260200190815260200160002060008282540192505081905550600160008154809291906001019190505550806004838154811015156103c457fe5b90600052602060002001819055505050565b6000600154905090565b60008060008091505b60008054905082101561043b5761041860008381548110151561040857fe5b9060005260206000200154610445565b90506002548110151561042e5760019250610440565b81806001019250506103e9565b600092505b505090565b60008060006104538461030f565b151561045e57600080fd5b60009150600090505b6002548110156104a8578360048281548110151561048157fe5b9060005260206000200154141561049b5781806001019250505b8080600101915050610467565b8192505050919050565b6000818154811015156104c157fe5b906000526020600020016000915090505481565b60006004828154811015156104e657fe5b90600052602060002001549050919050565b60025481565b60008080549050905090565b600360205280600052604060002060009150905054815600a165627a7a72305820ac0e32f51a300004f784d150f5b446f7742f765fd1a71a13690a42e04820f8b90029',
    gas: 3000000
  }, function(e, contract){
    console.log(contract.transactionHash);
    if (typeof contract.address != 'undefined') {
      console.log('Contract mined! address: ' + contract.address
        + ' transactionHash: ' + contract.transactionHash);
    }
  });
while(true) {
  admin.sleep(1);
  nPendingTxLen = web3.eth.pendingTransactions.length;
  //console.log("Current PendingTxLen=" + nPendingTxLen);
  if(nPendingTxLen <= 0) 
    break;
}
